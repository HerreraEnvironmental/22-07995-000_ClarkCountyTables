---
editor_options: 
  markdown: 
    wrap: 72
    output: pdf
---

------------------------------------------------------------------------

## Some Notes

Summarize SMP reach by repeat categories (different categories can be
collapsed into one, data can be summed)

Our deliverables: 2 tables per watershed 36 total Happy medium with
level of polish Appended to a word document, final export as pdf pdf
would be best probably

END OF THURSDAY AT THE VERY LATEST

We can at least shorten the table titles. How about: "Change in Tree
Canopy and Supporting Metrics, [Watershed_Name] Watershed and Reaches"
for the first series of tables, and "Change in Impervious Cover and
Supporting Metrics, [Watershed_Name] Watershed and Reaches" for the
second.

```{r import_packages, results='hide'}
library(data.table)
library(gtsummary)
library(kableExtra)
library(knitr)
library(readxl)
library(tidyverse)
options(scipen = 999)
```

## Read in excel file

```{r read_data}
## Import
files <- list.files(pattern = "*.xlsx", path = "data_raw/", 
                    recursive = TRUE, full.names = TRUE)
raw.data <- read_excel(files, .name_repair = "universal")
```

## Create the first table

```{r Table1}
source("R/create_table1.R")
allen <- export.table[[1]]

```


```{r}
export.table %>%
  imap(~ save_kable(file = paste0("figures/", .y, "Canopy Metrics.png"),
                    self_contained = TRUE, 
                    x = knitr::kable(.x, 
                      caption = paste0("Change in Tree Canopy and Supporting Metrics ",
                                       .y, " Watershed and Reaches"), 
                      align = "l",
                      booktabs = TRUE,
                      longtable = FALSE,
                      linesep = "") %>%
                      kable_styling(
                        position = "left",
                        latex_options = c("striped", "repeat_header", "scale_down"),
                        stripe_color = "#048CBD",
                        full_width = FALSE)))

```

```{r}
export.table2 %>%
  imap(~ save_kable(file = paste0("figures/", .y, " Impervious Metrics.png"),
                    self_contained = TRUE, 
                    x = knitr::kable(.x, 
                      caption = paste0("Change in Impervious Cover and Supporting Metrics ",
                                       .y, " Watershed and Reaches"), 
                      align = "l",
                      booktabs = TRUE,
                      longtable = FALSE,
                      linesep = "") %>%
                      kable_styling(
                        position = "left",
                        latex_options = c("striped", "repeat_header", "scale_down"),
                        stripe_color = "#048CBD",
                        full_width = FALSE)))

```


```{r maketables}

for (i in 1:length(export.table)){
    print(kable(export.table[[i]],
                    caption = paste("Change in Tree Canopy and Supporting Metrics, Watershed and Reaches"),
    format = "latex",
    align = "l",
    booktabs = TRUE,
    longtable = FALSE,
    linesep = "") %>%
        kableExtra::kable_styling(
      position = "left",
      latex_options = c("striped", "repeat_header", "scale_down"),
      stripe_color = "gray!15",
      full_width = FALSE) %>%
        row_spec(row = 0, background = "#048CBD") %>%
        save_kable(., paste("figures/", names(export.table[i]), ".pdf"), keep_tex = FALSE)
) 
    cat("\n")
}


allen.table <- allen %>%
  knitr::kable(
    caption = paste("Change in Tree Canopy and Supporting Metrics,",
                    names(export.table[1]), "Watershed and Reaches"),
    format = "latex",
    align = "l",
    booktabs = TRUE,
    longtable = FALSE,
    linesep = "") %>%
  kableExtra::kable_styling(
      position = "left",
      latex_options = c("striped", "repeat_header", "scale_down"),
      stripe_color = "gray!15",
      full_width = FALSE) %>%
  row_spec(row = 0, background = "#048CBD") %>%
  save_kable(., paste("figures/", names(export.table[1]), ".pdf"), keep_tex = FALSE)
```


